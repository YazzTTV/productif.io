"use client"

import { useEffect, createContext, useContext, useState, ReactNode } from 'react';

// Types des traductions
export type Locale = 'fr' | 'en';

// Type des cl√©s de traduction
export type TranslationKey = keyof typeof translations.fr;

// Context pour la gestion de la langue
type LocaleContextType = {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  t: (key: string) => string;
};

const LocaleContext = createContext<LocaleContextType | undefined>(undefined);

// Provider pour la langue
export function LocaleProvider({ children, initialLocale = 'fr' }: { children: ReactNode, initialLocale?: Locale }) {
  const [locale, setLocale] = useState<Locale>(initialLocale);

  // R√©cup√©ration de la langue depuis le localStorage au chargement
  useEffect(() => {
    const savedLocale = localStorage.getItem('locale') as Locale;
    if (savedLocale && (savedLocale === 'fr' || savedLocale === 'en')) {
      setLocale(savedLocale);
    }
  }, []);

  // Sauvegarde de la langue dans le localStorage √† chaque changement
  useEffect(() => {
    localStorage.setItem('locale', locale);
    document.documentElement.lang = locale;
  }, [locale]);

  // Fonction de traduction
  const t = (key: string): string => {
    if (locale === 'fr' && key in translations.fr) {
      return translations.fr[key as keyof typeof translations.fr];
    } else if (locale === 'en' && key in translations.en) {
      return translations.en[key as keyof typeof translations.en];
    }
    return key;
  };

  return (
    <LocaleContext.Provider value={{ locale, setLocale, t }}>
      {children}
    </LocaleContext.Provider>
  );
}

// Hook personnalis√© pour utiliser les traductions
export function useLocale() {
  const context = useContext(LocaleContext);
  if (context === undefined) {
    throw new Error('useLocale must be used within a LocaleProvider');
  }
  return context;
}

// Traductions
export const translations = {
  fr: {
    // Navigation
    'dashboard': 'Tableau de bord',
    'projects': 'Projets',
    'tasks': 'T√¢ches',
    'calendar': 'Calendrier',
    'analytics': 'Analyses',
    'settings': 'Param√®tres',
    'time': 'Temps',
    'deepWork': 'Travail profond',
    'habits': 'Habitudes',
    'objectives': 'Objectifs',
    'monEspace': 'Mon espace',
    'admin': 'Administration',
    'companies': 'Entreprises',
    'users': 'Utilisateurs',
    'adminDashboard': 'Tableau de bord admin',
    'memberTasks': 'T√¢ches des membres',
    'teamPerformance': 'Performance d\'√©quipe',
    'quit': 'Quitter',
    
    // Param√®tres
    'accountInfo': 'Informations du compte',
    'managePersonalInfo': 'G√©rez vos informations personnelles',
    'email': 'Email',
    'name': 'Nom',
    'memberSince': 'Membre depuis',
    'password': 'Mot de passe',
    'changePassword': 'Changer le mot de passe',
    'currentPassword': 'Mot de passe actuel',
    'newPassword': 'Nouveau mot de passe',
    'confirmNewPassword': 'Confirmer le nouveau mot de passe',
    'update': 'Mettre √† jour',
    'updating': 'Mise √† jour...',
    'preferences': 'Pr√©f√©rences',
    'customizeExperience': 'Personnalisez votre exp√©rience',
    'theme': 'Th√®me',
    'light': 'Clair',
    'dark': 'Sombre',
    'system': 'Syst√®me',
    'language': 'Langue',
    'notifications': 'Notifications',
    'manageNotifications': 'G√©rez vos pr√©f√©rences de notifications',
    'emailNotifications': 'Notifications par email',
    'receiveEmailNotifications': 'Recevoir des notifications par email',
    'taskReminders': 'Rappels de t√¢ches',
    'receiveTaskReminders': 'Recevoir des rappels pour les t√¢ches √† venir',
    'accountDeletion': 'Suppression du compte',
    'deleteAccount': 'Supprimer le compte',
    'deleteAccountDescription': 'Supprimez d√©finitivement votre compte et toutes vos donn√©es',
    'areYouSure': '√ätes-vous s√ªr ?',
    'irreversibleAction': 'Cette action est irr√©versible. Toutes vos donn√©es seront supprim√©es d√©finitivement.',
    'typeDeleteToConfirm': 'Pour confirmer, √©crivez SUPPRIMER en majuscules.',
    'cancel': 'Annuler',
    'deleting': 'Suppression...',
    'success': 'Succ√®s',
    'error': 'Erreur',
    'settingsUpdated': 'Vos param√®tres ont √©t√© mis √† jour.',
    'passwordUpdated': 'Votre mot de passe a √©t√© mis √† jour.',
    'passwordMismatch': 'Les mots de passe ne correspondent pas.',
    'passwordTooShort': 'Le nouveau mot de passe doit contenir au moins 8 caract√®res.',
    'accountDeleted': 'Compte supprim√©',
    'accountDeletedDescription': 'Votre compte et toutes vos donn√©es ont √©t√© supprim√©s.',
    'invalidConfirmation': 'La confirmation n\'est pas valide. Veuillez √©crire SUPPRIMER en majuscules.',
    
    // Onboarding marketing flow
    'onboardingWelcomeTitle': 'Productif.io',
    'onboardingWelcomeSubtitle': 'Ma√Ætrisez votre focus. Mesurez votre progression.',
    'onboardingGetStarted': 'Commencer',
    'onboardingLogin': 'Se connecter',
    'onboardingChooseLanguageTitle': 'Choisissez votre langue',
    'onboardingChooseLanguageSubtitle': 'S√©lectionnez la langue de votre exp√©rience',
    'onboardingContinue': 'Continuer',
    'onboardingChangeLanguageInfo': 'Vous pourrez modifier cette langue plus tard dans les param√®tres',
    'onboardingConnectTitle': 'Connectez votre compte',
    'onboardingConnectSubtitle': 'Cr√©ez votre compte pour d√©bloquer toutes les fonctionnalit√©s et synchroniser vos donn√©es sur tous vos appareils',
    'onboardingContinueWithEmail': 'Continuer avec l‚Äôemail',
    'onboardingContinueWithApple': 'Continuer avec Apple',
    'onboardingContinueWithGoogle': 'Continuer avec Google',
    'onboardingOr': 'ou',
    'onboardingAlreadyHaveAccount': 'Vous avez d√©j√† un compte ?',
    'onboardingSkipForNow': 'Passer pour le moment',
    'onboardingCreateAccountTitle': 'Rejoignez l\'√âlite ‚Äî Cr√©ez votre compte',
    'onboardingCreateAccountSubtitle': 'Essai gratuit de 7 jours ‚Ä¢ Aucune carte bancaire requise',
    'onboardingBenefitAI': 'Assistant IA pour vous guider 24h/24 et 7j/7',
    'onboardingBenefitHabits': 'Suivez vos habitudes et cr√©ez des s√©ries',
    'onboardingBenefitAnalytics': 'Analyses avanc√©es et insights',
    'onboardingBenefitCompete': 'Rivalisez avec vos amis',
    'onboardingBenefitSync': 'Synchronisation sur tous vos appareils',
    'earlyAdopters': '+1500 early adopters',
    'earlyAdoptersText': '+1500 premiers utilisateurs',
    
    // Settings Page
    'backToDashboard': 'Retour au tableau de bord',
    'account': 'COMPTE',
    'yourName': 'Votre nom',
    'profileSettings': 'Param√®tres du profil',
    'eliteAccess': 'Acc√®s Elite',
    'premiumElite': 'Premium Elite',
    'joinTopPerformers': 'Rejoignez 10 000+ top performers',
    'monthly': 'Mensuel',
    'annual': 'Annuel',
    'save20': '√âCONOMISEZ 20%',
    'youSave': 'Vous √©conomisez 60‚Ç¨/an',
    'that33Off': 'C\'est 33% de r√©duction !',
    'bestDeal': 'MEILLEURE OFFRE',
    'limitedSpotsRemaining': 'Places limit√©es restantes',
    'only3SpotsLeft': 'Seulement 3 places restantes √† ce prix',
    'unlimitedAICoaching': 'Coaching IA illimit√©',
    'prioritySupport247': 'Support prioritaire 24/7',
    'advancedAnalytics': 'Analyses avanc√©es',
    'flexibleBilling': 'Facturation flexible',
    'billedAnnually': 'Factur√© annuellement √† 119,88‚Ç¨',
    'getEliteAccessNow': 'Obtenir l\'acc√®s Elite maintenant',
    'getAnnualEliteAccess': 'Obtenir l\'acc√®s Elite annuel',
    'offerExpires24h': '‚è∞ Offre expire dans 24 heures',
    'annualOfferExpires24h': '‚è∞ Offre annuelle expire dans 24 heures',
    'preferences': 'PR√âF√âRENCES',
    'helpSupport': 'Aide & Support',
    'privacyTerms': 'Confidentialit√© & Conditions',
    'logOut': 'Se d√©connecter',
    'nameUpdatedSuccess': 'Nom mis √† jour avec succ√®s',
    'unableToUpdateName': 'Impossible de mettre √† jour le nom',
    
    // Dashboard
    'hello': 'Bonjour',
    'makeTodayProductive': 'Rendons aujourd\'hui incroyablement productif',
    'dailyProgress': 'Progression quotidienne',
    'focusTime': 'Temps de concentration',
    'today': 'Aujourd\'hui',
    'currentStreak': 'S√©rie actuelle',
    'days': 'jours',
    'keepItUp': 'Continuez comme √ßa !',
    'score': 'Score',
    'productivity': 'Productivit√©',
    'weeklyPerformance': 'Performance hebdomadaire',
    'productivityTrendWeek': 'Votre tendance de productivit√© cette semaine',
    'fullAnalytics': 'Analyses compl√®tes',
    'performanceMetrics': 'M√©triques de performance',
    'totalHours': 'Heures totales',
    'tasksDone': 'T√¢ches termin√©es',
    'peakTime': 'Heure de pointe',
    'rank': 'Classement',
    'dailyHabits': 'Habitudes quotidiennes',
    'done': 'Termin√©',
    'addHabit': 'Ajouter une habitude',
    'habitNamePlaceholder': 'Nom de l\'habitude (ex: M√©ditation, Exercice...)',
    'create': 'Cr√©er',
    'cancel': 'Annuler',
    'noHabitsToday': 'Aucune habitude pour aujourd\'hui',
    'tasks': 'T√¢ches',
    'viewAll': 'Voir tout',
    'completed': 'Termin√©',
    'greatProgress': 'Excellent progr√®s ! Continuez üöÄ',
    'leaderboard': 'Classement',
    'noLeaderboardData': 'Aucune donn√©e de classement',
    'recentAchievements': 'R√©compenses r√©centes',
    'unlockedBadgesChallenges': 'Vos badges d√©bloqu√©s et d√©fis √† venir',
    'viewAllAchievements': 'Voir tout',
    'unlocked': 'D√©bloqu√©',
    'required': 'requis',
    'points': 'pts',
    'noAchievementsAvailable': 'Aucune r√©compense disponible',
    'loading': 'Chargement...',
    'errorLoadingData': 'Erreur lors du chargement des donn√©es',
    'aiAssistant': 'Assistant IA',
    'errorCreatingHabit': 'Erreur lors de la cr√©ation de l\'habitude',
    'monday': 'Lun',
    'tuesday': 'Mar',
    'wednesday': 'Mer',
    'thursday': 'Jeu',
    'friday': 'Ven',
    'saturday': 'Sam',
    'sunday': 'Dim',
    
    // Achievements Page
    'unlockRewardsObjectives': 'D√©bloquez des r√©compenses en accomplissant vos objectifs',
    'globalProgress': 'Progression globale',
    'unlockedAchievements': 'Achievements d√©bloqu√©s',
    'all': 'Tous',
    'noAchievementsInCategory': 'Aucun achievement dans cette cat√©gorie',
    'unableToLoadAchievements': 'Impossible de charger les achievements',
    'streaks': 'S√©ries',
    'regularity': 'R√©gularit√©',
    
    // Achievements
    'First Step': 'Premier pas',
    'Complete your first habit': 'Compl√©tez votre premi√®re habitude',
    'Week on Fire': 'Une semaine de feu',
    'Maintain a 7-day streak': 'Maintenez une s√©rie de 7 jours',
    'Consistency Master': 'Ma√Ætre de la constance',
    'Maintain a 30-day streak': 'Maintenez une s√©rie de 30 jours',
    'Living Legend': 'L√©gende vivante',
    'Maintain a 100-day streak': 'Maintenez une s√©rie de 100 jours',
    'Motivated Beginner': 'D√©butant motiv√©',
    'Complete 10 habits in total': 'Compl√©tez 10 habitudes au total',
    'Habit Enthusiast': 'Habitu√© des habitudes',
    'Complete 100 habits in total': 'Compl√©tez 100 habitudes au total',
    'Habit Machine': 'Machine √† habitudes',
    'Complete 500 habits in total': 'Compl√©tez 500 habitudes au total',
    'Supreme Master': 'Ma√Ætre supr√™me',
    'Complete 1000 habits in total': 'Compl√©tez 1000 habitudes au total',
    'Perfect Day': 'Journ√©e parfaite',
    'Complete all your habits in one day': 'Compl√©tez toutes vos habitudes en une journ√©e',
    'Points Collector': 'Collectionneur de points',
    'Reach 100 points': 'Atteignez 100 points',
    'Points Rich': 'Riche en points',
    'Reach 500 points': 'Atteignez 500 points',
    'Points Millionaire': 'Millionnaire des points',
    'Reach 1000 points': 'Atteignez 1000 points',
    'First Task': 'Premi√®re t√¢che',
    'Complete your first task': 'Compl√©tez votre premi√®re t√¢che',
    'Productive': 'Productif',
    'Complete 10 tasks': 'Compl√©tez 10 t√¢ches',
    'Super Productive': 'Super productif',
    'Complete 100 tasks': 'Compl√©tez 100 t√¢ches',
    'First Objective': 'Premier objectif',
    'Create your first objective': 'Cr√©ez votre premier objectif',
    'Strategist': 'Strat√®ge',
    'Complete 5 objectives': 'Compl√©tez 5 objectifs',
  },
  en: {
    // Navigation
    'dashboard': 'Dashboard',
    'projects': 'Projects',
    'tasks': 'Tasks',
    'calendar': 'Calendar',
    'analytics': 'Analytics',
    'settings': 'Settings',
    'time': 'Time',
    'deepWork': 'Deep Work',
    'habits': 'Habits',
    'objectives': 'Objectives',
    'monEspace': 'My Space',
    'admin': 'Administration',
    'companies': 'Companies',
    'users': 'Users',
    'adminDashboard': 'Admin Dashboard',
    'memberTasks': 'Member Tasks',
    'teamPerformance': 'Team Performance',
    'quit': 'Quit',
    
    // Settings
    'accountInfo': 'Account Information',
    'managePersonalInfo': 'Manage your personal information',
    'email': 'Email',
    'name': 'Name',
    'memberSince': 'Member since',
    'password': 'Password',
    'changePassword': 'Change password',
    'currentPassword': 'Current password',
    'newPassword': 'New password',
    'confirmNewPassword': 'Confirm new password',
    'update': 'Update',
    'updating': 'Updating...',
    'preferences': 'Preferences',
    'customizeExperience': 'Customize your experience',
    'theme': 'Theme',
    'light': 'Light',
    'dark': 'Dark',
    'system': 'System',
    'language': 'Language',
    'notifications': 'Notifications',
    'manageNotifications': 'Manage your notification preferences',
    'emailNotifications': 'Email notifications',
    'receiveEmailNotifications': 'Receive email notifications',
    'taskReminders': 'Task reminders',
    'receiveTaskReminders': 'Receive reminders for upcoming tasks',
    'accountDeletion': 'Account Deletion',
    'deleteAccount': 'Delete account',
    'deleteAccountDescription': 'Permanently delete your account and all your data',
    'areYouSure': 'Are you sure?',
    'irreversibleAction': 'This action is irreversible. All your data will be permanently deleted.',
    'typeDeleteToConfirm': 'To confirm, type DELETE in capital letters.',
    'cancel': 'Cancel',
    'deleting': 'Deleting...',
    'success': 'Success',
    'error': 'Error',
    'settingsUpdated': 'Your settings have been updated.',
    'passwordUpdated': 'Your password has been updated.',
    'passwordMismatch': 'Passwords do not match.',
    'passwordTooShort': 'New password must be at least 8 characters long.',
    'accountDeleted': 'Account deleted',
    'accountDeletedDescription': 'Your account and all your data have been deleted.',
    'invalidConfirmation': 'Invalid confirmation. Please type DELETE in capital letters.',
    
    // Onboarding marketing flow
    'onboardingWelcomeTitle': 'Productif.io',
    'onboardingWelcomeSubtitle': 'Master your focus. Measure your growth.',
    'onboardingGetStarted': 'Get Started',
    'onboardingLogin': 'Log in',
    'onboardingChooseLanguageTitle': 'Choose Your Language',
    'onboardingChooseLanguageSubtitle': 'Select your preferred language',
    'onboardingContinue': 'Continue',
    'onboardingChangeLanguageInfo': 'You can change this later in settings',
    'onboardingConnectTitle': 'Connect Your Account',
    'onboardingConnectSubtitle': 'Create your account to unlock all features and sync your data across devices',
    'onboardingContinueWithEmail': 'Continue with Email',
    'onboardingContinueWithApple': 'Continue with Apple',
    'onboardingContinueWithGoogle': 'Continue with Google',
    'onboardingOr': 'or',
    'onboardingAlreadyHaveAccount': 'Already have an account?',
    'onboardingSkipForNow': 'Skip for now',
    'onboardingCreateAccountTitle': 'Join the Elite ‚Äî Create Your Account',
    'onboardingCreateAccountSubtitle': 'Free 7-day trial ‚Ä¢ No credit card required',
    'onboardingBenefitAI': 'AI Assistant to guide you 24/7',
    'onboardingBenefitHabits': 'Track habits & build streaks',
    'onboardingBenefitAnalytics': 'Advanced analytics & insights',
    'onboardingBenefitCompete': 'Compete with friends',
    'onboardingBenefitSync': 'Sync across all devices',
    'earlyAdopters': '+1500 early adopters',
    'earlyAdoptersText': '+1500 early adopters',
    
    // Settings Page
    'backToDashboard': 'Back to Dashboard',
    'account': 'ACCOUNT',
    'yourName': 'Your name',
    'profileSettings': 'Profile Settings',
    'eliteAccess': 'Elite Access',
    'premiumElite': 'Premium Elite',
    'joinTopPerformers': 'Join 10,000+ top performers',
    'monthly': 'Monthly',
    'annual': 'Annual',
    'save20': 'SAVE 20%',
    'youSave': 'You save ‚Ç¨60/year',
    'that33Off': 'That\'s 33% off!',
    'bestDeal': 'BEST DEAL',
    'limitedSpotsRemaining': 'Limited spots remaining',
    'only3SpotsLeft': 'Only 3 spots left at this price',
    'unlimitedAICoaching': 'Unlimited AI Coaching',
    'prioritySupport247': '24/7 Priority Support',
    'advancedAnalytics': 'Advanced Analytics',
    'flexibleBilling': 'Flexible billing',
    'billedAnnually': 'Billed annually at ‚Ç¨119.88',
    'getEliteAccessNow': 'Get Elite Access Now',
    'getAnnualEliteAccess': 'Get Annual Elite Access',
    'offerExpires24h': '‚è∞ Offer expires in 24 hours',
    'annualOfferExpires24h': '‚è∞ Annual offer expires in 24 hours',
    'preferences': 'PREFERENCES',
    'helpSupport': 'Help & Support',
    'privacyTerms': 'Privacy & Terms',
    'logOut': 'Log Out',
    'nameUpdatedSuccess': 'Name updated successfully',
    'unableToUpdateName': 'Unable to update name',
    
    // Dashboard
    'hello': 'Hello',
    'makeTodayProductive': 'Let\'s make today incredibly productive',
    'dailyProgress': 'Daily Progress',
    'focusTime': 'Focus Time',
    'today': 'Today',
    'currentStreak': 'Current Streak',
    'days': 'days',
    'keepItUp': 'Keep it up!',
    'score': 'Score',
    'productivity': 'Productivity',
    'weeklyPerformance': 'Weekly Performance',
    'productivityTrendWeek': 'Your productivity trend this week',
    'fullAnalytics': 'Full Analytics',
    'performanceMetrics': 'Performance Metrics',
    'totalHours': 'Total Hours',
    'tasksDone': 'Tasks Done',
    'peakTime': 'Peak Time',
    'rank': 'Rank',
    'dailyHabits': 'Daily Habits',
    'done': 'Done',
    'addHabit': 'Add Habit',
    'habitNamePlaceholder': 'Habit name (e.g., Meditation, Exercise...)',
    'create': 'Create',
    'cancel': 'Cancel',
    'noHabitsToday': 'No habits for today',
    'tasks': 'Tasks',
    'viewAll': 'View All',
    'completed': 'Completed',
    'greatProgress': 'Great progress! Keep it up üöÄ',
    'leaderboard': 'Leaderboard',
    'noLeaderboardData': 'No leaderboard data',
    'recentAchievements': 'Recent Achievements',
    'unlockedBadgesChallenges': 'Your unlocked badges and upcoming challenges',
    'viewAllAchievements': 'View All',
    'unlocked': 'Unlocked',
    'required': 'required',
    'points': 'pts',
    'noAchievementsAvailable': 'No achievements available',
    'loading': 'Loading...',
    'errorLoadingData': 'Error loading data',
    'aiAssistant': 'AI Assistant',
    'errorCreatingHabit': 'Error creating habit',
    'monday': 'Mon',
    'tuesday': 'Tue',
    'wednesday': 'Wed',
    'thursday': 'Thu',
    'friday': 'Fri',
    'saturday': 'Sat',
    'sunday': 'Sun',
    
    // Achievements Page
    'unlockRewardsObjectives': 'Unlock rewards by achieving your objectives',
    'globalProgress': 'Global Progress',
    'unlockedAchievements': 'Unlocked achievements',
    'all': 'All',
    'noAchievementsInCategory': 'No achievements in this category',
    'unableToLoadAchievements': 'Unable to load achievements',
    'streaks': 'Streaks',
    'regularity': 'Regularity',
    
    // Achievements (keep English names as keys, return same for English)
    'First Step': 'First Step',
    'Complete your first habit': 'Complete your first habit',
    'Week on Fire': 'Week on Fire',
    'Maintain a 7-day streak': 'Maintain a 7-day streak',
    'Consistency Master': 'Consistency Master',
    'Maintain a 30-day streak': 'Maintain a 30-day streak',
    'Living Legend': 'Living Legend',
    'Maintain a 100-day streak': 'Maintain a 100-day streak',
    'Motivated Beginner': 'Motivated Beginner',
    'Complete 10 habits in total': 'Complete 10 habits in total',
    'Habit Enthusiast': 'Habit Enthusiast',
    'Complete 100 habits in total': 'Complete 100 habits in total',
    'Habit Machine': 'Habit Machine',
    'Complete 500 habits in total': 'Complete 500 habits in total',
    'Supreme Master': 'Supreme Master',
    'Complete 1000 habits in total': 'Complete 1000 habits in total',
    'Perfect Day': 'Perfect Day',
    'Complete all your habits in one day': 'Complete all your habits in one day',
    'Points Collector': 'Points Collector',
    'Reach 100 points': 'Reach 100 points',
    'Points Rich': 'Points Rich',
    'Reach 500 points': 'Reach 500 points',
    'Points Millionaire': 'Points Millionaire',
    'Reach 1000 points': 'Reach 1000 points',
    'First Task': 'First Task',
    'Complete your first task': 'Complete your first task',
    'Productive': 'Productive',
    'Complete 10 tasks': 'Complete 10 tasks',
    'Super Productive': 'Super Productive',
    'Complete 100 tasks': 'Complete 100 tasks',
    'First Objective': 'First Objective',
    'Create your first objective': 'Create your first objective',
    'Strategist': 'Strategist',
    'Complete 5 objectives': 'Complete 5 objectives',
  },
}; 